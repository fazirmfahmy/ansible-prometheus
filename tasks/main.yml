---
# tasks file for ansible-prometheus
- name: "Create Prometheus group."
  group:
    name: "{{ prometheus_group }}"
    state: present

- name: "Create Prometheus user"
  user:
    name: "{{ prometheus_owner }}"
    group: "{{ prometheus_group }}"
    createhome: no
    shell: /sbin/nologin
    state: present

- name: "Create {{ prometheus_install_dir }}"
  file:
    path: "{{ prometheus_install_dir }}"
    state: directory
    owner: "root"
    group: "root"
    mode: 0755

- name: "Install Prometheus."
  import_tasks: install-prometheus.yml
  when: prometheus_install

- name: "Install Prometheus node exporter"
  import_tasks: install-node-exporter.yml
  when: prometheus_node_exporter_install

- name: "Install Prometheus alert manager."
  import_tasks: install-alert-manager.yml
  when: prometheus_alert_manager_install

- name: "Install Pushgateway."
  import_tasks: install-push-gateway.yml
  when: prometheus_push_gateway_install

- name: "Install Prometheus SNMP exporter."
  import_tasks: install-snmp-exporter.yml
  when: prometheus_snmp_exporter_install

- name: "Install Prometheus Blackbox exporter."
  import_tasks: install-blackbox-exporter.yml
  when: prometheus_blackbox_exporter_install
